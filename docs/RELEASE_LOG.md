# セカカレ リリースログ

このドキュメントは、セカカレの主要な変更・リリース履歴を記録しています。

---

## [Unreleased]

### 🔄 進行中
- 地域別ソート時の表示バグ修正（Issue #112）

### 📝 予定
- Phase 1-B-5: CSPヘッダー追加（Issue #119）
- Phase 1-B-6: 自動テスト環境構築（Issue #118）

---

## [v0.4.0] - 2025-10-18

### ✨ 新機能
- **写真アップロード機能**（Phase 1-B-3）
  - 店舗訪問時の写真を最大3枚まで保存・表示
  - 自動画像圧縮（最大800px、品質0.7）
  - 画像拡大モーダル（キーボードナビゲーション対応）
  - localStorage容量監視（80%超過で警告）
  - (#116, #117)

### 🔒 セキュリティ強化
- Base64データの厳密な検証機能追加
  - `isValidBase64Image()`: 形式・文字列の検証
  - `sanitizeBase64Image()`: 不正データのフィルタリング
- XSS対策の強化
- エラーハンドリング改善（ユーザーフレンドリーなメッセージ）

### ♿ アクセシビリティ改善
- 画像拡大モーダルにARIA属性追加
  - `role="dialog"`, `aria-modal="true"`
  - ナビゲーションボタンに `aria-label`
- キーボード操作対応
  - Escapeキーでモーダルを閉じる
  - 矢印キーで画像をナビゲート

### 🔧 改善
- 関数の責任分離（小さく再利用可能な設計）
- parseInt のNaNチェック追加
- コード品質向上

### 📚 ドキュメント
- Issue #118: 自動テスト環境の構築（将来対応）
- Issue #119: CSPヘッダーの追加（将来対応）
- Issue #120: パフォーマンス最適化（Phase 2対応）

---

## [v0.3.0] - 2025-10-18

### ✨ 新機能
- **ログ並び替え機能**（Phase 1-B-4）
  - 日付順（新→旧 / 旧→新）
  - 地域別（都道府県）
  - 再訪回数順
  - localStorage でソート設定を保持
  - (#110, #111)

### 🔧 改善
- パフォーマンス最適化
  - visit-count ソートを O(n²) → O(n log n) に改善
- アクセシビリティ改善
  - ソートドロップダウンに aria-label 追加
- コード品質向上
  - 都道府県リストを定数化
  - localStorage のエラーハンドリング追加

### 📚 ドキュメント
- SYSTEM_SPEC.md 追加
- docs/PROJECT_GOALS.md 追加
- docs/RELEASE_LOG.md 追加

---

## [v0.2.0] - 2025-10-17

### ✨ 新機能
- **メニュー・メモ機能**（Phase 1-B-2）
  - 訪問時のメニューを記録
  - 自由なメモを追加
  - ログ一覧での表示
  - (#100, #106, #108)

### 🐛 バグ修正
- PR #106 と PR #107 のコンフリクト解決
- menu/memo が表示されない問題を修正
- visitedAt の優先度統一

### 🔧 改善
- 訪問日を任意（空欄可能）に変更
- 日付が空欄の場合「日付不明」と表示

---

## [v0.1.1] - 2025-10-06

### ✨ 新機能
- **編集モーダルUI**（Phase 1-B-1）
  - モーダルでの編集インターフェース
  - 訪問日の変更
  - 編集履歴の記録（editedAt）
  - (#94, #95)

### 🔧 改善
- 編集時のバリデーション強化
- 未来の日付選択を防止
- XSS対策の徹底

---

## [v0.1.0] - 2025-09-15

### ✨ 初回リリース（Phase 1-A完了）

**コア機能**
- Google Maps 連携
  - Autocomplete による店舗検索
  - Place Details API での情報取得
  - 地図上での店舗表示

- 訪問ログ管理
  - 店舗情報の保存（localStorage）
  - ログ一覧表示（月別グループ）
  - 基本的な編集・削除機能

- ユーザーインターフェース
  - トップページ（index.html）
  - ログページ（logs.html）
  - infoページ（info.html）
  - レスポンシブデザイン
  - ハンバーガーメニュー

**技術実装**
- Vanilla JavaScript（フレームワークなし）
- localStorage でのデータ永続化
- XSS対策（escapeHtml実装）
- GitHub Pages でのホスティング

---

## バージョニングルール

このプロジェクトは [Semantic Versioning](https://semver.org/) に従います：

- **Major (X.0.0)**: 破壊的な変更、大規模なアーキテクチャ変更
- **Minor (0.X.0)**: 新機能の追加、後方互換性あり
- **Patch (0.0.X)**: バグ修正、小さな改善

### 現在のバージョン戦略
- **v0.x.x**: MVP開発フェーズ（Phase 1）
- **v1.x.x**: 正式リリース（Phase 3完了後）
- **v2.x.x**: ソーシャル機能追加（Phase 4）

---

## Phase別の主要マイルストーン

### Phase 1: MVP（基本機能）
- ✅ **v0.1.0** - Phase 1-A: コア機能完成
- ✅ **v0.1.1** - Phase 1-B-1: 編集モーダルUI
- ✅ **v0.2.0** - Phase 1-B-2: メニュー・メモ機能
- ✅ **v0.3.0** - Phase 1-B-4: 並び替え機能
- ✅ **v0.4.0** - Phase 1-B-3: 写真アップロード機能
- 📝 **v0.5.0** - Phase 1-B-5: CSPヘッダー追加（予定）

### Phase 2: データ管理・分析
- 📝 **v0.6.0** - 統計ダッシュボード（予定）
- 📝 **v0.7.0** - エクスポート/インポート（予定）
- 📝 **v0.8.0** - 高度な検索機能（予定）

### Phase 3: PWA化
- 📝 **v1.0.0** - PWA対応、正式リリース（予定）

---

## 主要な技術的変更

### v0.4.0
- 画像圧縮アルゴリズムの実装（Canvas API）
- Base64データの厳密な検証機能追加
- localStorage容量監視機能
- データ構造に `photos` フィールド追加

### v0.3.0
- ソートアルゴリズムの最適化（O(n²) → O(n log n)）
- PREFECTURES 定数の導入
- localStorage エラーハンドリング追加

### v0.2.0
- データ構造に `menu`, `memo` フィールド追加
- `visitedAt` の優先度統一
- 空欄許容のバリデーション実装

### v0.1.1
- データ構造に `editedAt` フィールド追加
- モーダルUIパターンの確立

### v0.1.0
- 初期データ構造の設計
- localStorage スキーマの確立
- XSS対策の基本実装

---

## 既知の問題

### v0.4.0
- 大量の写真（100件以上）でスクロールパフォーマンス低下の可能性（Issue #120）

### v0.3.0
- 地域別ソート時に月別グループ表示される（Issue #112）

### 共通
- localStorage の容量制限（約5-10MB）
- プライベートブラウジングモードでの制限

---

## 廃止予定・非推奨

現在、廃止予定の機能はありません。

---

## 貢献者

- [@masahito-hub](https://github.com/masahito-hub) - メイン開発者

---

## リンク

- [GitHub Repository](https://github.com/masahito-hub/sekakare)
- [本番環境（GitHub Pages）](https://masahito-hub.github.io/sekakare/)
- [システム仕様書](../SYSTEM_SPEC.md)
- [プロジェクト目標](PROJECT_GOALS.md)

---

**最終更新**: 2025-10-18  
**現在のバージョン**: v0.4.0  
**次期バージョン**: v0.5.0（Phase 1-B-5: CSPヘッダー追加）
