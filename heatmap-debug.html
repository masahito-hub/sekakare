<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ« - ã‚»ã‚«ã‚«ãƒ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff8c00, #ffa500);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        h1 {
            color: #ff6b00;
            margin-bottom: 10px;
        }

        .description {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #ff6b00;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 2px solid #ff8c00;
            padding-bottom: 5px;
        }

        .param-group {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        .param-label {
            font-weight: bold;
            color: #333;
        }

        .param-description {
            grid-column: 2;
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        input[type="number"] {
            width: 150px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input[type="number"]:focus {
            border-color: #ff8c00;
            outline: none;
        }

        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-save {
            background: #ff8c00;
            color: white;
        }

        .btn-save:hover {
            background: #ff6b00;
        }

        .btn-reset {
            background: #ddd;
            color: #333;
        }

        .btn-reset:hover {
            background: #ccc;
        }

        .btn-back {
            background: #4CAF50;
            color: white;
        }

        .btn-back:hover {
            background: #45a049;
        }

        .status {
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .current-values {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ› ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
        <p class="description">
            Canvas-based ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã®æç”»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã§ãã¾ã™ã€‚<br>
            ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¤‰æ›´å¾Œã€ã€Œä¿å­˜ã—ã¦é©ç”¨ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‹ã‚‰ã€ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚
        </p>

        <div id="currentValues" class="current-values"></div>

        <div class="section">
            <h2>ã‚ºãƒ¼ãƒ é€£å‹•åŠå¾„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h2>
            <div class="param-group">
                <label class="param-label">z_ref</label>
                <input type="number" id="z_ref" step="1" min="1" max="20">
            </div>
            <div class="param-description">åŸºæº–ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ï¼ˆæ¨å¥¨: 14ï¼‰</div>

            <div class="param-group">
                <label class="param-label">r_base</label>
                <input type="number" id="r_base" step="1" min="1" max="100">
            </div>
            <div class="param-description">åŸºæº–åŠå¾„ [px]ï¼ˆæ¨å¥¨: 14ï¼‰</div>

            <div class="param-group">
                <label class="param-label">k</label>
                <input type="number" id="k" step="0.01" min="1" max="2">
            </div>
            <div class="param-description">åºƒåŸŸå´ã®ä¼¸ã³ä¿‚æ•°ï¼ˆæ¨å¥¨: 1.28ï¼‰</div>

            <div class="param-group">
                <label class="param-label">r_min_px</label>
                <input type="number" id="r_min_px" step="1" min="1" max="100">
            </div>
            <div class="param-description">æœ€å°ç”»é¢åŠå¾„ [px]ï¼ˆæ¨å¥¨: 16ï¼‰</div>

            <div class="param-group">
                <label class="param-label">r_max_px</label>
                <input type="number" id="r_max_px" step="1" min="1" max="200">
            </div>
            <div class="param-description">æœ€å¤§ç”»é¢åŠå¾„ [px]ï¼ˆæ¨å¥¨: 48ï¼‰</div>
        </div>

        <div class="section">
            <h2>å¯†åº¦ãƒ™ãƒ¼ã‚¹é€æ˜åº¦</h2>
            <div class="param-group">
                <label class="param-label">alpha_base</label>
                <input type="number" id="alpha_base" step="0.05" min="0" max="1">
            </div>
            <div class="param-description">åŸºæœ¬é€æ˜åº¦ï¼ˆæ¨å¥¨: 0.55ï¼‰</div>

            <div class="param-group">
                <label class="param-label">tau</label>
                <input type="number" id="tau" step="1" min="0" max="10">
            </div>
            <div class="param-description">å­¤ç«‹ãƒ–ãƒ¼ã‚¹ãƒˆã®é–¾å€¤ï¼ˆæ¨å¥¨: 3ï¼‰</div>

            <div class="param-group">
                <label class="param-label">isolation_boost</label>
                <input type="number" id="isolation_boost" step="0.05" min="1" max="3">
            </div>
            <div class="param-description">å­¤ç«‹ãƒ–ãƒ¼ã‚¹ãƒˆå€ç‡ï¼ˆæ¨å¥¨: 1.25ï¼‰</div>
        </div>

        <div class="section">
            <h2>LCHè‰²ãƒãƒƒãƒ—ï¼ˆé»„â†’ç¥ç€ï¼‰</h2>
            <h3 style="margin-top: 10px; margin-bottom: 10px; font-size: 14px;">æ·¡ã„é»„è‰²ï¼ˆæœ€è–„ï¼‰</h3>
            <div class="param-group">
                <label class="param-label">color_light_L</label>
                <input type="number" id="color_light_L" step="1" min="0" max="100">
            </div>
            <div class="param-description">æ˜åº¦ï¼ˆæ¨å¥¨: 95ï¼‰</div>

            <div class="param-group">
                <label class="param-label">color_light_C</label>
                <input type="number" id="color_light_C" step="1" min="0" max="150">
            </div>
            <div class="param-description">å½©åº¦ï¼ˆæ¨å¥¨: 45ï¼‰</div>

            <div class="param-group">
                <label class="param-label">color_light_H</label>
                <input type="number" id="color_light_H" step="1" min="0" max="360">
            </div>
            <div class="param-description">è‰²ç›¸ï¼ˆæ¨å¥¨: 95ï¼‰</div>

            <h3 style="margin-top: 20px; margin-bottom: 10px; font-size: 14px;">ç¥ç€è‰²ï¼ˆæœ€æ¿ƒï¼‰</h3>
            <div class="param-group">
                <label class="param-label">color_dark_L</label>
                <input type="number" id="color_dark_L" step="1" min="0" max="100">
            </div>
            <div class="param-description">æ˜åº¦ï¼ˆæ¨å¥¨: 72ï¼‰</div>

            <div class="param-group">
                <label class="param-label">color_dark_C</label>
                <input type="number" id="color_dark_C" step="1" min="0" max="150">
            </div>
            <div class="param-description">å½©åº¦ï¼ˆæ¨å¥¨: 65ï¼‰</div>

            <div class="param-group">
                <label class="param-label">color_dark_H</label>
                <input type="number" id="color_dark_H" step="1" min="0" max="360">
            </div>
            <div class="param-description">è‰²ç›¸ï¼ˆæ¨å¥¨: 80ï¼‰</div>

            <div class="param-group">
                <label class="param-label">gamma</label>
                <input type="number" id="gamma" step="0.05" min="0.5" max="3">
            </div>
            <div class="param-description">ã‚¬ãƒ³ãƒè£œæ­£ï¼ˆæ¨å¥¨: 1.45ï¼‰</div>
        </div>

        <div class="section">
            <h2>æ­£è¦åŒ–ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h2>
            <div class="param-group">
                <label class="param-label">percentile_low</label>
                <input type="number" id="percentile_low" step="1" min="0" max="50">
            </div>
            <div class="param-description">ä¸‹é™ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ï¼ˆæ¨å¥¨: 5ï¼‰</div>

            <div class="param-group">
                <label class="param-label">percentile_high</label>
                <input type="number" id="percentile_high" step="1" min="50" max="100">
            </div>
            <div class="param-description">ä¸Šé™ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ï¼ˆæ¨å¥¨: 95ï¼‰</div>

            <div class="param-group">
                <label class="param-label">debounce_ms</label>
                <input type="number" id="debounce_ms" step="50" min="0" max="1000">
            </div>
            <div class="param-description">ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ™‚é–“ [ms]ï¼ˆæ¨å¥¨: 150ï¼‰</div>
        </div>

        <div class="buttons">
            <button class="btn-save" onclick="saveParams()">ğŸ’¾ ä¿å­˜ã—ã¦é©ç”¨</button>
            <button class="btn-reset" onclick="resetParams()">ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™</button>
            <button class="btn-back" onclick="goBack()">ğŸ  ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸</button>
        </div>

        <div id="status" class="status"></div>
    </div>

    <script>
        const defaultParams = {
            z_ref: 14,
            r_base: 14,
            k: 1.28,
            r_min_px: 16,
            r_max_px: 48,
            alpha_base: 0.55,
            tau: 3,
            isolation_boost: 1.25,
            color_light_L: 95,
            color_light_C: 45,
            color_light_H: 95,
            color_dark_L: 72,
            color_dark_C: 65,
            color_dark_H: 80,
            gamma: 1.45,
            percentile_low: 5,
            percentile_high: 95,
            debounce_ms: 150
        };

        function loadParams() {
            const saved = localStorage.getItem('sekakare_heatmap_params');
            const params = saved ? JSON.parse(saved) : defaultParams;

            for (const key in params) {
                const input = document.getElementById(key);
                if (input) {
                    input.value = params[key];
                }
            }

            displayCurrentValues(params);
        }

        function displayCurrentValues(params) {
            const div = document.getElementById('currentValues');
            div.textContent = 'ç¾åœ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:\n' + JSON.stringify(params, null, 2);
        }

        function saveParams() {
            const params = {};

            for (const key in defaultParams) {
                const input = document.getElementById(key);
                if (input) {
                    params[key] = parseFloat(input.value);
                }
            }

            localStorage.setItem('sekakare_heatmap_params', JSON.stringify(params));

            const status = document.getElementById('status');
            status.className = 'status success';
            status.textContent = 'âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å¤‰æ›´ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
            status.style.display = 'block';

            displayCurrentValues(params);

            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        function resetParams() {
            if (confirm('ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem('sekakare_heatmap_params');

                for (const key in defaultParams) {
                    const input = document.getElementById(key);
                    if (input) {
                        input.value = defaultParams[key];
                    }
                }

                displayCurrentValues(defaultParams);

                const status = document.getElementById('status');
                status.className = 'status info';
                status.textContent = 'â„¹ï¸ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«æˆ»ã—ã¾ã—ãŸã€‚ã€Œä¿å­˜ã—ã¦é©ç”¨ã€ã‚’æŠ¼ã—ã¦ç¢ºå®šã—ã¦ãã ã•ã„ã€‚';
                status.style.display = 'block';

                setTimeout(() => {
                    status.style.display = 'none';
                }, 5000);
            }
        }

        function goBack() {
            window.location.href = '/';
        }

        // Load params on page load
        loadParams();
    </script>
</body>
</html>
